import spacy
from spacy.matcher import Matcher
from flask import Flask, request, jsonify

nlp = spacy.load("en_core_web_sm")

app = Flask(__name__)

#pattern-response pairs for the chatbot
patterns = [
    (r'(hi|hello|hey|hola)', ['Hello!', 'Hi there!', 'Hey!', 'Hi, MeloBot this side, what\'s up?']),
    (r'(what can you do|what can melobot do)', ['I can help you with music recommendations, tell you about things which can be done on melosynthia and can clarify your doubts regarding this ai', 'I can tell you about NFTs', 'I am but a robot after all']),
    (r'(how are you|how are you doing)', ['I am good, thank you!', 'I am just a chatbot, but I am fine.']),
    (r'what can you do', ['I can help you generate music, create NFTs of generated lyrics, and provide music-related recommendations. Just ask me!']),
    (r'(how do you know what music to recommend to me)', ['I use machine learning algorithms to analyze your music preferences and past listening habits. The more you interact with me and provide feedback, the better I can fine-tune my recommendations.']),
    (r'(can you suggest new and trending songs or artists)', ['Absolutely! I can keep you updated on the latest music releases, popular artists, and trending tracks in various genres.']),
    (r'who created MeloSynthia', ['team web3 sailors created melosynthia']),
    (r'what type of nfts does melosynthia makes', ['musical nfts']),
    (r'who is greatest footballer player in the world?', ['Lionel Messi is considered as the greatest player to play the game of football']),
    (r'how can I generate music', [" You can generate music by giving a prompt text as an input and selecting your preferences and then simply press enter. The music+lyrics will generate automatically afterwards."]),
    (r'how can I make nfts of my generated lyrics', ["After generating, By simply clicking on the nft button you can make it as an NFT and list them in our marketplace."]),
    (r'give me an example prompt for how can I generate professional tunes', [" Various prompt examples are:\n1. A 90's pop culture music with drum beats\n2. American style beats with Indian music\n3. Taylor Swift's style of lyrics on ambient music tunes"]),(r"what is Tron", ["Tron is a blockchain-based decentralized platform that aims to build a global, free content entertainment system with distributed storage technology. It focuses on enabling the creation and sharing of digital content using blockchain and peer-to-peer (P2P) technology."]),
    (r"how does Tron work", ["Tron uses a Delegated Proof of Stake (DPoS) consensus mechanism to validate transactions and produce blocks. It also supports smart contracts, allowing developers to create decentralized applications (DApps) on the Tron blockchain."]),
    (r"what is BTT", ["BTT is a cryptocurrency token built on the Tron blockchain. It is designed to be used within the BitTorrent ecosystem to incentivize users to share and seed files on the BitTorrent network. BTT can also be used for various other applications and services within the Tron ecosystem."]),
    (r"how can I use BTT", ["You can use BTT to tip content creators on the BitTorrent network, purchase premium features on BitTorrent Speed, or trade it on cryptocurrency exchanges. It's a versatile token that can be used in various ways within the BitTorrent and Tron ecosystems."]),
    (r"what are the benefits of using Tron and BTT", ["Using Tron and BTT can provide benefits such as faster transaction speeds, lower fees, and access to a wide range of decentralized applications and services. Additionally, BTT can incentivize content sharing and contribute to a more robust and decentralized file-sharing ecosystem."]),
    (r"how can I get started with Tron and BTT", ["To get started with Tron and BTT, you can create a Tron wallet, acquire TRX (Tron's native cryptocurrency), and explore the Tron and BitTorrent ecosystems. You can also participate in the Tron and BTT communities to learn more and stay updated on developments."]),
    (r"what is the future of Tron and BTT", ["The future of Tron and BTT looks promising, with ongoing developments and partnerships. Tron continues to expand its ecosystem, and BTT is being integrated into various BitTorrent products. Both technologies are positioned to play significant roles in the blockchain and decentralized content sharing spaces."]),
    (r"tell me more about MeloSynthia", ["MeloSynthia is an AI-powered music generation and NFT creation platform. It uses advanced algorithms to create unique music compositions and lyrics that you can turn into NFTs. You can also explore our marketplace to buy and sell musical NFTs created by other users."]),
    (r"how do I create an account on MeloSynthia", ["To create an account on MeloSynthia, visit our website and click on the 'Sign Up' button. Follow the on-screen instructions to complete the registration process. Once you have an account, you can start generating music and NFTs."]),
    (r"can I customize the music generated by MeloSynthia", ["Yes, you can customize the music generated by MeloSynthia by providing specific preferences and prompts when generating music. This allows you to tailor the music to your liking."]),
    (r"what are the benefits of using MeloSynthia for music creation", ["Using MeloSynthia for music creation offers benefits such as quick and AI-assisted music composition, the ability to turn your creations into NFTs for potential earnings."]),
    (r"can I sell my musical NFTs on other marketplaces", ["Yes, you can sell your musical NFTs created on MeloSynthia on other NFT marketplaces as well. MeloSynthia provides you with the flexibility to list your NFTs on different platforms."]),
    (r"how can I earn from my musical NFTs", ["You can earn from your musical NFTs by selling them in the MeloSynthia marketplace"]),
    (r"tell me a music-related joke", ["Why did the music teacher go to jail? Because she got caught with too many sharp objects!"]),
    (r"who is your favorite musician", ["I don't have any personal preferences, there are a lot of good genres and music out there"]),
    (r"what's the weather like today", ["I'm sorry, I can't provide real-time weather information. You might want to check a weather website or app for the latest updates."]),
    (r"can you recommend some relaxing music", ["Of course! How about some instrumental piano music or ambient sounds to help you relax?"]),
    (r"what's your favorite NFT project", ["I'm just a chatbot, so I don't have personal favorites. However, there are many exciting NFT projects out there."]),
    (r"What is the Tron ecosystem?",["The Tron ecosystem encompasses the Tron blockchain, its native cryptocurrency (TRX), decentralized applications (DApps), and various projects built on or connected to the Tron network."]),
    (r"What are the key components of the Tron ecosystem?",["The key components include the Tron blockchain, TRX token, DApps, wallets, smart contracts, and various protocols."]),
    (r"How does the Tron blockchain work?", ["The Tron blockchain uses Delegated Proof of Stake (DPoS) consensus, where elected super representatives validate transactions and create blocks."]),
    (r" What is the significance of TRX in the Tron ecosystem?", ["TRX serves as the native cryptocurrency of the Tron network, used for transactions, smart contract execution, and governance."]),
    (r"What is the role of decentralized applications (DApps) in the Tron ecosystem?",["DApps built on Tron provide various services, including gaming, DeFi, NFTs, and more, utilizing the Tron blockchain's capabilities."]),
    (r"Can you name some popular DApps on Tron?", ["Popular Tron DApps include WINk, JustSwap, Sun.io, and TronTrade."]),
    (r"What are Tron wallets, and which ones are recommended?",["Tron wallets are software or hardware tools to store and manage TRX and other TRC tokens. Recommended wallets include TronLink, Trust Wallet, and Ledger Live."]),
    (r"How secure is the Tron blockchain?",["The Tron blockchain is considered secure due to its DPoS consensus mechanism and active community participation."]),
    (r"What is TronScan, and how can it be used",["TronScan is a block explorer for the Tron blockchain, allowing users to explore transactions, addresses, and smart contracts."]),
    (r"How can developers build DApps on Tron?",["Developers can use the Tron Virtual Machine (TVM) and developer tools provided by Tron to create and deploy DApps."]),
    (r"Can I stake TRX tokens to earn rewards in the Tron ecosystem?", ["Yes, you can stake TRX to earn rewards, often through Super Representatives (SRs) or Delegated Validators."]),
    (r"What are Super Representatives (SRs) in the Tron ecosystem?", ["Super Representatives are elected nodes responsible for validating transactions, producing blocks, and participating in network governance"]),
    (r"How does Tron handle governance and protocol upgrades?", ["Governance decisions are made through token holder voting, and protocol upgrades can be proposed by the community."]),
    (r"What is the Sun Network, and why is it important?", ["The Sun Network is a scaling solution for Tron, enhancing network capacity and efficiency for improved scalability."])
    (r"What is the TRC-20 standard on Tron?" ["TRC-20 is a token standard on Tron, similar to Ethereum's ERC-20, used for creating fungible tokens."]),
    (r"How does Tron address privacy concerns?",["Tron offers optional privacy features through projects like TRONZ, allowing for private transactions."]),
    (r"Can I create my own token on the Tron blockchain?", ["Yes, developers can create custom tokens on Tron using its blockchain."]),
    (r"What is the Tron Arcade, and how does it support game developers?",["Tron Arcade is a fund and accelerator program that supports game developers building on the Tron blockchain."]),
    (r"Is Tron environmentally friendly compared to other blockchains?",["Tron's DPoS consensus mechanism is designed to be energy-efficient, potentially reducing environmental impact."]),
    (r"What is the total supply of TRX tokens?" ["The total supply of TRX is capped at approximately 100 billion tokens."]),
    (r" How can I store TRX securely?", ["You can store TRX in cryptocurrency wallets, including hardware wallets, mobile wallets, and desktop wallets."]),
    (r"Can I mine TRX tokens?", ["No, TRX cannot be mined; it is pre-mined and distributed through block rewards and super representative rewards."]),
    (r"How does Tron address cross-chain compatibility?",["Tron is working on solutions like the TRC cross-chain protocol to facilitate interoperability with other blockchains."]),
    (r"How can I participate in Tron's DeFi ecosystem?",["You can participate in Tron's DeFi projects by providing liquidity, farming, or trading on decentralized exchanges (DEXs)."]),
    (r"What is BitTorrent's connection to Tron?",["Tron acquired BitTorrent, integrating its technology and user base into the Tron ecosystem."]),
    (r"What is BitTorrent Speed, and how does it work with TRX?", ["BitTorrent Speed is a feature that allows users to earn TRX by sharing files on the BitTorrent network."]),
    (r"Can I use Tron for crowdfunding or ICOs?",["Yes, Tron's blockchain can be used for crowdfunding and initial coin offerings (ICOs) through smart contracts."]),
    (r"How does Tron address transaction finality?",["Transactions on the Tron blockchain are considered final after a certain number of block confirmations."]),
    (r"How does Tron address security vulnerabilities?",["Tron follows best security practices, and developers can conduct audits of their smart contracts to enhance security."]),
    (r"What is the TronLink wallet, and how does it work?",["TronLink is a browser extension wallet that allows users to interact with Tron DApps and manage their TRX holdings."]),
    (r"What is TRC-721, and how is it used on Tron?",["TRC-721 is a token standard for non-fungible tokens (NFTs) on Tron, used for unique digital assets."]),
    (r"What is TRC-140, and what are its features?",["TRC-140 is a token standard for fungible tokens with additional features, such as dividend distribution."]),
    (r"Can I earn passive income with Tron?",["Yes, by staking TRX or participating in Tron's DeFi ecosystem, you can potentially earn passive income."]),
    (r"How does Tron handle interoperability with other blockchains?",["Tron is working on cross-chain solutions to enhance interoperability with other blockchains."]),
    (r"What is the TRON Foundation, and what is its role?",["The TRON Foundation is a nonprofit organization that supports the development and adoption of the Tron blockchain."]),
    (r"How can I stay updated on Tron's latest developments and news?",["You can follow Tron's official website, social media channels, and community forums for updates."]),
    (r"What are some challenges facing the Tron ecosystem?",["Challenges include regulatory compliance, competition with other blockchains, and user education."]),
    (r"Can I use Tron for microtransactions and in-app purchases?",["Yes, Tron's low transaction fees make it suitable for microtransactions and in-app purchases."]),
    (r"How does Tron's energy concept work, and what is energy used for?",["Energy in Tron is used to execute smart contracts and can be generated through freezing TRX tokens or acquiring them through transactions."]),
    (r"What is the minimum amount of TRX required to create a Tron wallet?",["You can create a Tron wallet with a minimum of 0.1 TRX for the account creation fee."]),
    (r"What is the Tron 4.0 update, and what are its features?",["Tron 4.0 introduced features like the TPOS consensus mechanism, which enhances the network's security and efficiency."]),
    (r"Can I use Tron for charity and fundraising initiatives?",["Yes, Tron's blockchain can be utilized for charity and fundraising projects, providing transparency and security."]),
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r"")
    (r'(.*)', ["I'm sorry, I don't understand. You can ask me about generating music or for general information."]),
    

]

matcher = Matcher(nlp.vocab)

for pattern, responses in patterns:
    pattern_tokens = [{"TEXT": {"REGEX": pattern}}]
    matcher.add(pattern,[pattern_tokens])  

# Function to chat with the user
def get_chatbot_response(user_input):
    doc = nlp(user_input)
    matches = matcher(doc)
    if matches:
        match_id, _, _ = matches[0]
        response = patterns[match_id][1]  #responses for the matched pattern
    else:
        response = ["I'm sorry, I don't understand. You can ask me about generating music, making NFTs, or for general information."]
    return response[0]

# Route for handling chatbot requests
@app.route('/api/melobot', methods=['POST'])
def chatbot_response_endpoint():
    user_message = request.json.get('message')
    chatbot_response = get_chatbot_response(user_message)
    return jsonify({'message': chatbot_response})

if __name__ == "__main__":
    app.run(debug=True)
